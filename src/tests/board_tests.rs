use crate::{
    board::Board,
    board_geometry_templates::{Bitboard, FILE_A, FILE_B, FILE_H, RANK_3, RANK_7, RANK_8},
    enums::PieceColor,
};

#[test]
pub fn occupancy_test1() -> () {
    let mut test_board: Board = Board::set();
    test_board.white_occupancy();
    test_board.black_occupancy();
    test_board.total_occupancy();

    assert_eq!(
        test_board.white_occupancy.unwrap(),
        0b1111111111111111000000000000000000000000000000000000000000000000
    );
    assert_eq!(
        test_board.black_occupancy.unwrap(),
        0b0000000000000000000000000000000000000000000000001111111111111111
    );
    assert_eq!(
        test_board.total_occupancy.unwrap(),
        0b1111111111111111000000000000000000000000000000001111111111111111
    );
}

#[test]
pub fn occupancy_test2() -> () {
    let mut test_board: Board = Board {
        white_pawns: 0b0000000011010000001000000000000000000000000000000000000000000000,
        white_knights: 0b0000000000000000010000000000000000010000100000000000000000000000,
        white_bishops: 0b0100000000000000000000000000000000000000000000000000000000000000,
        white_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_rooks: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_king: 0b0000000000000000000000000000000100000000000000000000000000000000,
        black_pawns: 0b0000000000000000000000000000000000000000000000000101011000000000,
        black_knights: 0b0000000000000000000000000000000000000000000000000000000000100000,
        black_bishops: 0b0000000000000010100000000000000000000000000000000000000000000000,
        black_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_rooks: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_king: 0b0000000000000000000000000000000000000000000000000000000000000001,
        white_occupancy: None,
        black_occupancy: None,
        total_occupancy: None,
    };

    test_board.white_occupancy();
    test_board.black_occupancy();
    test_board.total_occupancy();

    assert_eq!(
        test_board.white_occupancy.unwrap(),
        0b0100000011010000011000000000000100010000100000000000000000000000
    );
    assert_eq!(
        test_board.black_occupancy.unwrap(),
        0b0000000000000010100000000000000000000000000000000101011000100001
    );
    assert_eq!(
        test_board.total_occupancy.unwrap(),
        0b0100000011010010111000000000000100010000100000000101011000100001
    );
}

#[test]
pub fn pawn_moves_test1() -> () {
    let mut test_board: Board = Board {
        white_pawns: 0b0000000000000000000000000000000000000000000000000000001100000000,
        white_knights: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_rooks: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_pawns: 0b0000000000000000000000000000000000000000000000010000000000000000,
        black_knights: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_rooks: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_occupancy: None,
        black_occupancy: None,
        total_occupancy: None,
    };
    test_board.white_occupancy();
    test_board.black_occupancy();
    test_board.total_occupancy();

    assert_eq!(
        test_board.white_pawn_moves(),
        0b0000000000000000000000000000000000000010000000110000000000000000
    );
    assert_eq!(
        test_board.black_pawn_moves(),
        0b0000000000000000000000000000000000000000000000000000001000000000
    );
}

#[test]
pub fn pawn_moves_test2() -> () {
    let mut test_board: Board = Board {
        white_pawns: 0b0000000000000000000000000000000000110000000000000000000000000000,
        white_knights: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_rooks: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_pawns: 0b0000000000000000000100000010100000000000000000000000000000000000,
        black_knights: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_rooks: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_occupancy: None,
        black_occupancy: None,
        total_occupancy: None,
    };
    test_board.white_occupancy();
    test_board.black_occupancy();
    test_board.total_occupancy();

    assert_eq!(
        test_board.white_pawn_moves(),
        0b0000000000000000000000000011100000000000000000000000000000000000
    );
    assert_eq!(
        test_board.black_pawn_moves(),
        0b0000000000000000000000000001000000011000000000000000000000000000
    );
}

#[test]
pub fn knight_moves_test1() -> () {
    let mut test_board: Board = Board {
        white_pawns: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_knights: 0b0000000000000000000100000000000000000000000000000000001010000000,
        white_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_rooks: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_pawns: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_knights: 0b1000000000000010000000000000000000000000000000000000000000000000,
        black_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_rooks: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_occupancy: None,
        black_occupancy: None,
        total_occupancy: None,
    };
    test_board.white_occupancy();
    test_board.black_occupancy();
    test_board.total_occupancy();

    assert_eq!(
        test_board.knight_moves(PieceColor::Black),
        0b0000100000100000010010000000010100000000000000000000000000000000
    );
    assert_eq!(
        test_board.knight_moves(PieceColor::White),
        0b0010100001000100000000000100010000101101010010000010000000001000
    );
}

#[test]
pub fn knight_moves_test2() -> () {
    let mut test_board: Board = Board {
        white_pawns: 0b0000100000000000000010000000010100000000000000000000000000000000,
        white_knights: 0b0000000000000010000000000000000000000000000000000000000000000000,
        white_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_rooks: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_pawns: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_knights: 0b0000000000000000000000000000000000000000001000000000000000000000,
        black_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_queens: 0b0000000000000000000000000100000000001000000000000000100001010000,
        black_rooks: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_occupancy: None,
        black_occupancy: None,
        total_occupancy: None,
    };

    test_board.white_occupancy();
    test_board.black_occupancy();
    test_board.total_occupancy();

    assert_eq!(
        test_board.knight_moves(PieceColor::Black),
        0b0000000000000000000000000001000010000000000000001000000000000000
    );
    assert_eq!(
        test_board.knight_moves(PieceColor::White),
        0b0000000000000000000000000000000000000000000000000000000000000000
    );
}

#[test]
pub fn bishop_moves_test1() -> () {
    let mut test_board: Board = Board {
        white_pawns: 0b0000000011101111000000000000000000000000000000000000000000000000,
        white_knights: 0b0100001000000000000000000000000000000000000000000000000000000000,
        white_bishops: 0b0010010000000000000000000000000000000000000000000000000000000000,
        white_queens: 0b0001000000000000000000000000000000000000000000000000000000000000,
        white_rooks: 0b1000000100000000000000000000000000000000000000000000000000000000,
        white_king: 0b0000100000000000000000000000000000000000000000000000000000000000,
        black_pawns: 0b0000000000000000000000000000000000000000000000001111011100000000,
        black_knights: 0b0000000000000000000000000000000000000000000000000000000001000010,
        black_bishops: 0b0000000000000000000000000000000000000000000000000000000000100100,
        black_queens: 0b0000000000000000000000000000000000000000000000000000000000010000,
        black_rooks: 0b0000000000000000000000000000000000000000000000000000000010000001,
        black_king: 0b0000000000000000000000000000000000000000000000000000000000001000,
        white_occupancy: None,
        black_occupancy: None,
        total_occupancy: None,
    };

    test_board.white_occupancy();
    test_board.black_occupancy();
    test_board.total_occupancy();

    assert_eq!(
        test_board.bishop_moves(PieceColor::White),
        0b0000000000010000000010000000010000000010000000010000000000000000
    );
    assert_eq!(
        test_board.bishop_moves(PieceColor::Black),
        0b0000000000000000100000000100000000100000000100000000100000000000
    );
}

#[test]
pub fn bishop_moves_test2() -> () {
    let mut test_board: Board = Board {
        white_pawns: 0b0000000000000000000000000000000000000000000000000000000000010100,
        white_knights: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_bishops: 0b0000000000000000000000000000000000000000000000000000100000000000,
        white_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_rooks: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_pawns: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_knights: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_bishops: 0b0100000000000000000000000000000000000000000000000000000000000000,
        black_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_king: 0b0000000000000000000000000000000000000100000000000000000000000000,
        black_rooks: 0b0000000000000000000000000100000000000000000000000000000000000000,
        white_occupancy: None,
        black_occupancy: None,
        total_occupancy: None,
    };

    test_board.white_occupancy();
    test_board.black_occupancy();
    test_board.total_occupancy();

    assert_eq!(
        test_board.bishop_moves(PieceColor::Black),
        0b0000000010100000000100000000100000000000000000000000000000000000
    );
    assert_eq!(
        test_board.bishop_moves(PieceColor::White),
        0b0000000000000000000000000100000100100010000101000000000000000000
    );
}

#[test]
pub fn rook_moves_test1() -> () {
    let mut test_board: Board = Board {
        white_pawns: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_knights: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_queens: 0b0000000000000000000000000000000000000000000000000000000000000001,
        white_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_rooks: 0b0000000000000000000000000000000000000000000000000000000000000010,
        black_pawns: 0b0000000000000000000000000000000000000000000000000000000000001000,
        black_knights: 0b0000000000000000000000000000000000000000000000100000000000000000,
        black_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_rooks: 0b0000000000000000000000000000000000000000000000010000000000000000,
        white_occupancy: None,
        black_occupancy: None,
        total_occupancy: None,
    };

    test_board.white_occupancy();
    test_board.black_occupancy();
    test_board.total_occupancy();

    assert_eq!(
        test_board.rook_moves(PieceColor::White),
        0b0000000000000000000000000000000000000000000000100000001000001100
    );
    assert_eq!(test_board.rook_moves(PieceColor::Black), FILE_A & !RANK_3);
}

#[test]
pub fn rook_moves_test2() -> () {
    let mut test_board: Board = Board {
        white_pawns: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_knights: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_rooks: 0b0000000000000000000000000000000000000000000000000000000011111111,
        black_pawns: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_knights: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_queens: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_rooks: 0b1111111100000000000000000000000000000000000000000000000000000000,
        white_occupancy: None,
        black_occupancy: None,
        total_occupancy: None,
    };

    test_board.white_occupancy();
    test_board.black_occupancy();
    test_board.total_occupancy();

    assert_eq!(
        test_board.rook_moves(PieceColor::Black),
        0b0000000011111111111111111111111111111111111111111111111111111111
    );
    assert_eq!(
        test_board.rook_moves(PieceColor::White),
        0b1111111111111111111111111111111111111111111111111111111100000000
    )
}

#[test]
pub fn queen_moves_test1() -> () {
    let mut test_board: Board = Board {
        white_pawns: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_knights: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_queens: 0b1000000000000000000000000000000000000000000000000000000000000000,
        white_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_rooks: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_pawns: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_knights: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_bishops: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_queens: 0b0000000001000000000000000000000000000000000000000000000000000000,
        black_king: 0b0000000000000000000000000000000000000000000000000000000000000000,
        black_rooks: 0b0000000000000000000000000000000000000000000000000000000000000000,
        white_occupancy: None,
        black_occupancy: None,
        total_occupancy: None,
    };

    test_board.white_occupancy();
    test_board.black_occupancy();
    test_board.total_occupancy();
    println!("{:b}", test_board.queen_moves(PieceColor::Black));

    assert_eq!(
        test_board.queen_moves(PieceColor::White),
        ((FILE_H | RANK_8) & !0b1000000000000000000000000000000000000000000000000000000000000000)
            | 0b1000000001000000001000000001000000001000000001000000001000000000
    );
    assert_eq!(
        test_board.queen_moves(PieceColor::Black),
        ((FILE_B | RANK_7) & !0b0000000001000000000000000000000000000000000000000000000000000000)
            | 0b0000000100000001000000010000000100000001000000010000000000000001
    );
}
